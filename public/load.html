<html>
<head>
    <script src="http://localhost:3001/socket.io/socket.io.js"></script>
    <script src="/jquery-2.0.3.min.js"></script>
    <style>
        body {
            background-color: #000;
            color: #ddd;
        }
    </style>
</head>
<body>
    <div id="connection"></div>
    <div id="registration"></div>

    <div>
        <div id="register-block">
            <button type="button" id="register" value="register">register</button>
        </div>
    </div>

    <script>
        var socket = io.connect('http://localhost:3001');
        var instructions = [1, 0, 0, 0, 0, 0, 0, 0, 0, 0];
        var offset = 0;
        socket.on('connect', function (data) {
            if (this.socket.connected) {
                $('#connection').html('you\'re connected');
            }
        });
        socket.on('registered', function(data) {
            if (data.registered) {
                $('#register-block').hide();
                $('#registration').text('Registered as ' + data.offset);
                offset = data.offset;
            }
        });
        socket.on('start', function(data) {
            var i = offset;
            setInterval(function() {
                var instruction = instructions[i];
                if (instruction == 1) {
                    $('body').css({
                        backgroundColor: '#fff'
                    });
                } else {
                    $('body').css({
                        backgroundColor: '#000'
                    });
                }
                i = (i + 1) % instructions.length;
            }, 200)
        });

        CF = {
            register: function() {
                socket.emit('register');
            }
        };
        $(document).on('ready', CF.register);
    </script>
</body>
</html>
